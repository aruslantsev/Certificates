function res = PM40_OBR13(E1, E2, G12, nu12, thr, dg)
%+/-40

P = [  0    5   10   15   20   25   30   35   40   45    50    55    60    65    70    75    80    85    90]; 
d0=[2278 2474 2692 2923 3161 3429 3750 4046 4377 4733  5122  5565  6040  6546  7082  7761  8319  9172 10000]; 
d1=[2110 2326 2540 2768 3001 3254 3576 3879 4191 4528  4925  5360  5818  6284  6841  7415  8053  8894  9698]; 
d2=[2298 2019 1742 1451 1126  765  341  -58 -483 -983 -1461 -2061 -2642 -3293 -4019 -4806 -5717 -6994 -8162]; 
d3=[1318 1459 1651 1870 2074 2309 2535 2782 3059 3341  3652  4010  4352  4766  5145  5578  6041  6619  7175]; 
d4=[1964 1763 1506 1243  953  647  233 -133 -540 -994 -1472 -2025 -2579 -3206 -3911 -4629 -5477 -6666 -7791];  
b=20;
h=0.5;
sig = P * 10 / (b * h);
e0 = (d0 - d0(1)) * 4 * 10^-6 / 2.16;
e1 = (d1 - d1(1)) * 4 * 10^-6 / 2.16;
e2 = (d2 - d2(1)) * 4 * 10^-6 / 2.16;
e3 = (d3 - d3(1)) * 4 * 10^-6 / 2.16;
e4 = (d4 - d4(1)) * 4 * 10^-6 / 2.16;
eR = (e0 + e1 + e3) / 3;
eS = (e2 + e4) / 2;

P1 =[  0    5   10    15    20    25    30    40    50    60    70    80    90    100];
d01=[ 879 1103 1335  1559  1795  2059  2240  2769  3351  4019  4818  5747  6903  8382];
d11=[ 613  786  998  1264  1456  1726  1983  2541  3192  3972  4909  6003  7346  9231];
d21=[-334 -560 -806 -1061 -1326 -1630 -1828 -2483 -3190 -4061 -5056 -6278 -7702 -9635];
d31=[  16  205  389   576   771  1005  1100  1538  1997  2507  3103  3783  4511  5340];
d41=[-454 -696 -951 -1204 -1519 -1837 -2234 -2906 -3685 -4571 -5643 -6917 -8431 -10500];
b1=20;
h1=0.5;    
sig1 = P1 * 10 / (b1 * h1);
e01 = (d01 - d01(1)) * 4 * 10^-6 / 2.16;
e11 = (d11 - d11(1)) * 4 * 10^-6 / 2.16;
e21 = (d21 - d21(1)) * 4 * 10^-6 / 2.16;
e31 = (d31 - d31(1)) * 4 * 10^-6 / 2.16;
e41 = (d41 - d41(1)) * 4 * 10^-6 / 2.16;
eR1 = (e01 + e11 + e31) / 3;
eS1 = (e21 + e41) / 2;

P2=[  0      5      10      15      20      25      30       40       50     60      70       80      90      100];
d02=[667    839    1049    1260    1499    1734     2012    2576    3247    4074    5061     6360    7596    9666];
d12=[595    785    1015    1251    1510    1762     2051    2647    3398    4257    5331     6719    8091    10000];
d22=[-134   -347   -604    -867    -1159   -1460   -1806    -2504   -3351   -4392   -5745   -7422    -9132   -11500];
d32=[577    744    942     1156    1357    1581     1826    2312    2865    3514    4303    5194     6093    7327];
d42=[-505   -702   -944    -1209   -1492   -1767   -2134    -2826   -3667   -4720   -5970   -7581    -9267   -11500];
b2=20;
h2=0.56;    
sig2 = P2 * 10 / (b2 * h2);
e02 = (d02 - d02(1)) * 4 * 10^-6 / 2.16;
e12 = (d12 - d12(1)) * 4 * 10^-6 / 2.16;
e22 = (d22 - d22(1)) * 4 * 10^-6 / 2.16;
e32 = (d32 - d32(1)) * 4 * 10^-6 / 2.16;
e42 = (d42 - d42(1)) * 4 * 10^-6 / 2.16;
eR2 = (e02 + e12 + e32) / 3;
eS2 = (e22 + e42) / 2;

S = [sig sig1 sig2];
Ex = [eR eR1 eR2];
Ey = [eS eS1 eS2];

Alpha=[40 -40];
H_m = [0.5 0.5];
Sigma = 0:10:100;
[ExR0, EyR0] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, dg, Sigma);
[ExR1, EyR1] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 1, Sigma);
[ExR2, EyR2] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 2, Sigma);
[ExR3, EyR3] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 3, Sigma);

%plot(ExR0*100,Sigma,'k-x', EyR0*100,Sigma,'k-x', ExR1*100,Sigma,'k-s', EyR1*100,Sigma,'k-s', ExR2*100,Sigma,'k-+', EyR2*100,Sigma,'k-+', ExR3*100,Sigma,'k-v', EyR3*100,Sigma,'k-v', Ex*100,S,'ko', Ey*100,S,'ko')
plot(ExR0*100,Sigma,'b-', EyR0*100,Sigma,'b-', Ex*100,S,'ko', Ey*100,S,'ko')
ylabel('\sigma_x, Ãœ‡')
xlabel('\epsilon_y, \epsilon_x, %')
grid on

res = 0;
