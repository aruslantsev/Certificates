function res = PM20_OBR7(E1, E2, G12, nu12, thr, dg)
% +/-20

P = [   0    50   100   200   300    400];
d0=[   94   450   804  1525  2322   3212];
d1=[ -107   268   660  1420  2272   3296];
d2=[-1100 -2004 -3062 -5264 -8009 -12254];
d3=[ -174   149   535  1289  2123   2986];
d4=[-1430 -2141 -2949 -4594 -6663  -9574];  
b=20;
h=0.5;
sig = P * 10 / (b * h);
e0 = (d0 - d0(1)) * 4 * 10^-6 / 2.16;
e1 = (d1 - d1(1)) * 4 * 10^-6 / 2.16;
e2 = (d2 - d2(1)) * 4 * 10^-6 / 2.16;
e3 = (d3 - d3(1)) * 4 * 10^-6 / 2.16;
e4 = (d4 - d4(1)) * 4 * 10^-6 / 2.16;
eR = (e0 + e1 + e3) / 3;
eS = (e2 + e4) / 2;

P1 = [ 0   50   100  150  200   250   300   350  400]; 
d01=[2240 2707 3065 3394 3751  4105  4485  4871  5305];
d11=[1801 2066 2455 2835 3250  3663  4160  4680  5159];
d21=[1877 1220  515 -171 -937 -1823 -2810 -3921 -5170];
d31=[1966 2255 2608 2979 3303  3696  4075  4475  5000];
d41=[1878 988   52 -955 -1895  -3076 -4427 -5854 -7000];
b1=20;
h1=0.5;
sig1 = P1 * 10 / (b1 * h1);
e01 = (d01 - d01(1)) * 4 * 10^-6 / 2.16;
e11 = (d11 - d11(1)) * 4 * 10^-6 / 2.16;
e21 = (d21 - d21(1)) * 4 * 10^-6 / 2.16;
e31 = (d31 - d31(1)) * 4 * 10^-6 / 2.16;
e41 = (d41 - d41(1)) * 4 * 10^-6 / 2.16;
eR1 = (e01 + e11 + e31) / 3;
eS1 = (e21 + e41) / 2;


P2 = [ 0   50   100  150  200  250      300 350];
d02=[2352 2741 3127 3500 3888  4287   4734 5176];
d12=[1955 2348 2756 3165 3590  4034   4525 5163];
d22=[1992 1315  570 -202 -1029 -1971  -3210 -4300];
d32=[2048 2377 2758 3134 3520  3967  4388 4800];
d42=[2259 1418 441 -591 -1727 -3102  -4766 -6200];  
b2=20;
h2=0.5;
sig2 = P2 * 10 / (b2 * h2);
e02 = (d02 - d02(1)) * 4 * 10^-6 / 2.16;
e12 = (d12 - d12(1)) * 4 * 10^-6 / 2.16;
e22 = (d22 - d22(1)) * 4 * 10^-6 / 2.16;
e32 = (d32 - d32(1)) * 4 * 10^-6 / 2.16;
e42 = (d42 - d42(1)) * 4 * 10^-6 / 2.16;
eR2 = (e02 + e12 + e32) / 3;
eS2 = (e22 + e42) / 2;

S = [sig sig1 sig2];
Ex = [eR eR1 eR2];
Ey = [eS eS1 eS2];

Alpha=[20 -20];
H_m = [0.5 0.5];
Sigma = 0:50:400;
[ExR0, EyR0] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, dg, Sigma);
[ExR1, EyR1] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 1, Sigma);
[ExR2, EyR2] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 2, Sigma);
[ExR3, EyR3] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 3, Sigma);


%plot(ExR0*100,Sigma,'k-x', EyR0*100,Sigma,'k-x', ExR1*100,Sigma,'k-s', EyR1*100,Sigma,'k-s', ExR2*100,Sigma,'k-+', EyR2*100,Sigma,'k-+', ExR3*100,Sigma,'k-v', EyR3*100,Sigma,'k-v', Ex*100,S,'ko', Ey*100,S,'ko')
plot(ExR0*100,Sigma,'b-', EyR0*100,Sigma,'b-', Ex*100,S,'ko', Ey*100,S,'ko')
ylabel('\sigma_x, Ãœ‡')
xlabel('\epsilon_y, \epsilon_x, %')
grid on

res = 0;
