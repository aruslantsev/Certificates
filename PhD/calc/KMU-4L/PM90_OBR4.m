function res = PM90_OBR4(E1, E2, G12, nu12, thr, dg)
% 90

P= [0 2.5 5 7.5];
d0=[2365 2735 3041 3528];
d1=[1680 2068 2331 2700];
d2=[712 692 686 657];
d3=[2669 3003 3356 3605];
d4=[1818 1809 1811 1805];
b=20;
h=0.5;
sig = P * 10 / (b * h);
e0 = (d0 - d0(1)) * 4 * 10^-6 / 2.16;
e1 = (d1 - d1(1)) * 4 * 10^-6 / 2.16;
e2 = (d2 - d2(1)) * 4 * 10^-6 / 2.16;
e3 = (d3 - d3(1)) * 4 * 10^-6 / 2.16;
e4 = (d4 - d4(1)) * 4 * 10^-6 / 2.16;
eR = (e0 + e1 + e3) / 3;
eS = (e2 + e4) / 2;

P1= [  0   1   2   3   4   5   6    7    8    9   10   11   12];
d01=[219 312 410 525 665  785 1011 1137 1272 1423 1577 1732 1892];
d11=[432 582 669 801 887 1002 1196 1321 1435 1579 1712 1861 1999];
d21=[143 137 136 133 130  129 125  122  120  117  114  113  111];
d31=[373 504 602 759 865 1000 1188 1330 1460 1597 1756 1891 2049];
d41=[32  28  28  29  28    28  27   26   23   24   23   22   22];  
b1=20;
h1=0.5;
sig1 = P1 * 10 / (b1 * h1);
e01 = (d01 - d01(1)) * 4 * 10^-6 / 2.16;
e11 = (d11 - d11(1)) * 4 * 10^-6 / 2.16;
e21 = (d21 - d21(1)) * 4 * 10^-6 / 2.16;
e31 = (d31 - d31(1)) * 4 * 10^-6 / 2.16;
e41 = (d41 - d41(1)) * 4 * 10^-6 / 2.16;
eR1 = (e01 + e11 + e31) / 3;
eS1 = (e21 + e41) / 2;

P2=  [0     1    2    3    4    5     6    7];
d02=[ 338  449  569  705  856  993 1269 1411];
d12=[ 227  400  549  718  868 1043 1318 1472];
d22=[-300 -304 -308 -312 -316 -321 -331 -331];
d32=[ 513  651  764  898 1033 1185 1397 1557];
d42=[   4    6    3    3    2    4   -4    1];
b2=20;
h2=0.5;
sig2 = P2 * 10 / (b2 * h2);
e02 = (d02 - d02(1)) * 4 * 10^-6 / 2.16;
e12 = (d12 - d12(1)) * 4 * 10^-6 / 2.16;
e22 = (d22 - d22(1)) * 4 * 10^-6 / 2.16;
e32 = (d32 - d32(1)) * 4 * 10^-6 / 2.16;
e42 = (d42 - d42(1)) * 4 * 10^-6 / 2.16;
eR2 = (e02 + e12 + e32) / 3;
eS2 = (e22 + e42) / 2;

S = [sig sig1 sig2];
Ex = [eR eR1 eR2];
Ey = [eS eS1 eS2];

Alpha=[90];
H_m = [1];
Sigma = 0:3:12;
[ExR0, EyR0] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, dg, Sigma);
[ExR1, EyR1] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 1, Sigma);
[ExR2, EyR2] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 2, Sigma);
[ExR3, EyR3] = nonlinear_deform(Alpha, H_m, E1, E2, G12, nu12, thr, 3, Sigma);

%plot(ExR0*100,Sigma,'k-x', EyR0*100,Sigma,'k-x', ExR1*100,Sigma,'k-s', EyR1*100,Sigma,'k-s', ExR2*100,Sigma,'k-+', EyR2*100,Sigma,'k-+', ExR3*100,Sigma,'k-v', EyR3*100,Sigma,'k-v', Ex*100,S,'ko', Ey*100,S,'ko')
plot(ExR0*100,Sigma,'b-', EyR0*100,Sigma,'b-', Ex*100,S,'ko', Ey*100,S,'ko')
ylabel('\sigma_x, Ãœ‡')
xlabel('\epsilon_y, \epsilon_x, %')
grid on

res = 0;
